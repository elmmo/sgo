!function(e,t,i){"use strict";"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return e.length>0&&this.substring(this.length-e.length,this.length)===e});var s=new Date,o="wickedpicker",n={now:s.getHours()+":"+s.getMinutes(),twentyFour:!1,upArrow:"wickedpicker__controls__control-up",downArrow:"wickedpicker__controls__control-down",close:"wickedpicker__close",hoverState:"hover-state",title:"Timepicker",showSeconds:!1,timeSeparator:" : ",secondsInterval:1,minutesInterval:1,beforeShow:null,afterShow:null,show:null,clearable:!1,closeOnClickOutside:!0,onClickOutside:function(){}};function r(t,i){this.element=e(t),this.options=e.extend({},n,i),this.element.addClass("hasWickedpicker"),this.element.attr("onkeypress","return false;"),this.element.attr("aria-showingpicker","false"),this.createPicker(),this.timepicker=e(".wickedpicker"),this.up=e("."+this.options.upArrow.split(/\s+/).join(".")),this.down=e("."+this.options.downArrow.split(/\s+/).join(".")),this.separator=e(".wickedpicker__controls__control--separator"),this.hoursElem=e(".wickedpicker__controls__control--hours"),this.minutesElem=e(".wickedpicker__controls__control--minutes"),this.secondsElem=e(".wickedpicker__controls__control--seconds"),this.meridiemElem=e(".wickedpicker__controls__control--meridiem"),this.close=e("."+this.options.close.split(/\s+/).join("."));var o=this.timeArrayFromString(this.options.now);this.options.now=new Date(s.getFullYear(),s.getMonth(),s.getDate(),o[0],o[1],o[2]),this.selectedHour=this.parseHours(this.options.now.getHours()),this.selectedMin=this.parseSecMin(this.options.now.getMinutes()),this.selectedSec=this.parseSecMin(this.options.now.getSeconds()),this.selectedMeridiem=this.parseMeridiem(this.options.now.getHours()),this.setHoverState(),this.attach(t),this.setText(t)}e.extend(r.prototype,{showPicker:function(t){"function"==typeof this.options.beforeShow&&this.options.beforeShow(t,this.timepicker);var i=e(t).offset();if(e(t).attr({"aria-showingpicker":"true",tabindex:-1}),this.setText(t),this.showHideMeridiemControl(),this.getText(t)!==this.getTime()){var s=this.getText(t),o=/\s[ap]m$/i,n=o.test(s)?s.substr(-2,2):null,r=s.replace(o,"").split(this.options.timeSeparator),c={};c.hours=r[0],c.minutes=r[1],c.meridiem=n,this.options.showSeconds&&(c.seconds=r[2]),this.setTime(c)}this.timepicker.css({"z-index":this.element.css("z-index")+1,position:"absolute",left:i.left,top:i.top+e(t)[0].offsetHeight}).show(),"function"==typeof this.options.show&&this.options.show(t,this.timepicker),this.handleTimeAdjustments(t)},hideTimepicker:function(t){var i;this.timepicker.hide(),"function"==typeof this.options.afterShow&&this.options.afterShow(t,this.timepicker),function(){var t=e.Deferred();return e('[aria-showingpicker="true"]').attr("aria-showingpicker","false"),t.promise()}().then((i=0,void setTimeout(function(){e('[aria-showingpicker="false"]').attr("tabindex",i)},400)))},createPicker:function(){if(0===e(".wickedpicker").length){var t='<div class="wickedpicker"><p class="wickedpicker__title">'+this.options.title+'<span class="wickedpicker__close"></span></p><ul class="wickedpicker__controls"><li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--hours" tabindex="-1">00</span><span class="'+this.options.downArrow+'"></span></li><li class="wickedpicker__controls__control--separator"><span class="wickedpicker__controls__control--separator-inner">:</span></li><li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--minutes" tabindex="-1">00</span><span class="'+this.options.downArrow+'"></span></li>';this.options.showSeconds&&(t+='<li class="wickedpicker__controls__control--separator"><span class="wickedpicker__controls__control--separator-inner">:</span></li><li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--seconds" tabindex="-1">00</span><span class="'+this.options.downArrow+'"></span> </li>'),t+='<li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--meridiem" tabindex="-1">AM</span><span class="'+this.options.downArrow+'"></span></li></ul></div>',e("body").append(t),this.attachKeyboardEvents()}},showHideMeridiemControl:function(){!1===this.options.twentyFour?e(this.meridiemElem).parent().show():e(this.meridiemElem).parent().hide()},showHideSecondsControl:function(){this.options.showSeconds?e(this.secondsElem).parent().show():e(this.secondsElem).parent().hide()},attach:function(s){var o=this;this.options.clearable&&o.makePickerInputClearable(s),e(s).attr("tabindex",0),e(s).on("click focus",function(i){e(o.timepicker).is(":hidden")&&(o.showPicker(e(this)),t.lastTimePickerControl=e(this),e(o.hoursElem).focus())});var n=function(i){if(e(o.timepicker).is(":visible")){if(e(i.target).is(o.close))o.hideTimepicker(t.lastTimePickerControl);else if(e(i.target).closest(o.timepicker).length||e(i.target).closest(e(".hasWickedpicker")).length)i.stopPropagation();else{if("function"==typeof o.options.onClickOutside?o.options.onClickOutside():console.warn("Type of onClickOutside must be a function"),!o.options.closeOnClickOutside)return;o.hideTimepicker(t.lastTimePickerControl)}t.lastTimePickerControl=null}};e(i).off("click",n).on("click",n)},attachKeyboardEvents:function(){e(i).on("keydown",e.proxy(function(t){switch(t.keyCode){case 9:"hasWickedpicker"!==t.target.className&&e(this.close).trigger("click");break;case 27:e(this.close).trigger("click");break;case 37:t.target.className!==this.hoursElem[0].className?e(t.target).parent().prevAll("li").not(this.separator.selector).first().children()[1].focus():e(t.target).parent().siblings(":last").children()[1].focus();break;case 39:t.target.className!==this.meridiemElem[0].className?e(t.target).parent().nextAll("li").not(this.separator.selector).first().children()[1].focus():e(t.target).parent().siblings(":first").children()[1].focus();break;case 38:e(":focus").prev().trigger("click");break;case 40:e(":focus").next().trigger("click")}},this))},setTime:function(e){this.setHours(e.hours),this.setMinutes(e.minutes),this.setMeridiem(e.meridiem),this.options.showSeconds&&this.setSeconds(e.seconds)},getTime:function(){return[this.formatTime(this.getHours(),this.getMinutes(),this.getMeridiem(),this.getSeconds())]},setHours:function(e){var t=new Date;t.setHours(e);var i=this.parseHours(t.getHours());this.hoursElem.text(i),this.selectedHour=i},getHours:function(){var e=new Date;return e.setHours(this.hoursElem.text()),e.getHours()},parseHours:function(e){return!1===this.options.twentyFour?(e+11)%12+1:e<10?"0"+e:e},setMinutes:function(e){var t=new Date;t.setMinutes(e);var i=t.getMinutes(),s=this.parseSecMin(i);this.minutesElem.text(s),this.selectedMin=s},getMinutes:function(){var e=new Date;return e.setMinutes(this.minutesElem.text()),e.getMinutes()},parseSecMin:function(e){return(e<10?"0":"")+e},setMeridiem:function(e){var t="";void 0===e?t="PM"===this.getMeridiem()?"AM":"PM":t=e;this.meridiemElem.text(t),this.selectedMeridiem=t},getMeridiem:function(){return this.meridiemElem.text()},setSeconds:function(e){var t=new Date;t.setSeconds(e);var i=t.getSeconds(),s=this.parseSecMin(i);this.secondsElem.text(s),this.selectedSec=s},getSeconds:function(){var e=new Date;return e.setSeconds(this.secondsElem.text()),e.getSeconds()},parseMeridiem:function(e){return e>11?"PM":"AM"},handleTimeAdjustments:function(t){var i=0;e(this.up).add(this.down).off("mousedown click touchstart").on("mousedown click",{Wickedpicker:this,input:t},function(t){if(1!=t.which)return!1;var s=this.className.indexOf("up")>-1?"+":"-",o=t.data;"mousedown"==t.type?i=setInterval(e.proxy(function(e){e.Wickedpicker.changeValue(s,e.input,this)},this,{Wickedpicker:o.Wickedpicker,input:o.input}),200):o.Wickedpicker.changeValue(s,o.input,this)}).bind("mouseup touchend",function(){clearInterval(i)})},changeValue:function(t,i,s){var o="+"===t?s.nextSibling:s.previousSibling,n=e(o).attr("class");if(n.endsWith("hours")){var r="+"===t?this.getHours()+1:this.getHours()-1;this.setHours(r)}else if(n.endsWith("minutes")){var c="+"===t?this.getMinutes()+this.options.minutesInterval:this.getMinutes()-this.options.minutesInterval;this.setMinutes(c)}else if(n.endsWith("seconds")){var a="+"===t?this.getSeconds()+this.options.secondsInterval:this.getSeconds()-this.options.secondsInterval;this.setSeconds(a)}else this.setMeridiem();this.setText(i)},setText:function(t){e(t).val(this.formatTime(this.selectedHour,this.selectedMin,this.selectedMeridiem,this.selectedSec)).change()},getText:function(t){return e(t).val()},formatTime:function(e,t,i,s){var o=e+this.options.timeSeparator+t;return this.options.showSeconds&&(o+=this.options.timeSeparator+s),!1===this.options.twentyFour&&(o+=" "+i),o},setHoverState:function(){var t=this;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||e(this.up).add(this.down).add(this.close).hover(function(){e(this).toggleClass(t.options.hoverState)})},makePickerInputClearable:function(t){e(t).wrap('<div class="clearable-picker"></div>').after("<span data-clear-picker>&times;</span>"),e("[data-clear-picker]").on("click",function(t){e(this).siblings(".hasWickedpicker").val("")})},timeArrayFromString:function(e){if(e.length){var t=e.split(":");return t[2]=t.length<3?"00":t[2],t}return!1},_time:function(){var t=e(this.element).val();return""===t?this.formatTime(this.selectedHour,this.selectedMin,this.selectedMeridiem,this.selectedSec):t},_hide:function(){this.hideTimepicker(this.element)}}),e.fn[o]=function(t,i){return e.isFunction(r.prototype["_"+t])?e(this).hasClass("hasWickedpicker")?void 0!==i?e.data(e(this)[i],"plugin_"+o)["_"+t]():e.data(e(this)[0],"plugin_"+o)["_"+t]():void 0:this.each(function(){e.data(this,"plugin_"+o)||e.data(this,"plugin_"+o,new r(this,t))})}}(jQuery,window,document);